<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Admin Dashboard</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

  <script src="admin.js"></script>

  <style>
    /* ======= DARK MODE ======= */
    body {
      background: #0f0f10;
      color: #e5e5e5;
      font-family: Inter, sans-serif;
    }

    .login-box, .panel-box {
      background: #18191a;
      padding: 28px;
      border-radius: 12px;
      box-shadow: 0 0 30px #0005;
      margin-bottom: 30px;
    }

    h2, h3 {
      color: #ffffff;
      font-weight: 600;
    }

    .table {
      color: #e5e5e5;
    }

    .table thead th {
      background: #202123;
      border-bottom: 1px solid #333;
    }

    .table tbody tr {
      background: #1b1c1d;
      border-color: #2a2a2a;
    }

    .table tbody tr:hover {
      background: #242526;
    }

    .form-control {
      background: #2a2b2d;
      border: none;
      color: #fff;
    }
    .form-control:focus {
      background: #333;
      color: #fff;
      border: 1px solid #444;
      box-shadow: none;
    }

    .btn-primary {
      background: #645cff;
      border: none;
    }
    .btn-primary:hover {
      background: #796fff;
    }

    .btn-danger {
      background: #ff4f4f;
      border: none;
    }

    .btn-success {
      background: #3cb675;
      border: none;
    }

    .stat-card {
      background: #1b1c1d;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 0 20px #0004;
      text-align: center;
    }

    .stat-number {
      font-size: 28px;
      font-weight: 700;
      color: #ffffff;
    }

    hr {
      border-color: #333;
      margin: 40px 0;
    }
  </style>
</head>

<body class="container py-5">

<!-- LOGIN SCREEN -->
<div id="loginBox" class="login-box w-50 mx-auto">
  <h2 class="mb-4">Admin Login</h2>

  <input id="password" class="form-control mb-3" type="password" placeholder="Enter admin password">
  <button class="btn btn-primary w-100" onclick="login()">Login</button>

  <div id="loginError" class="mt-3 text-danger" style="display:none;">
    Incorrect password
  </div>
</div>

<!-- ADMIN PANEL -->
<div id="adminPanel" style="display:none;">

  <!-- DASHBOARD -->
  <div class="panel-box">
    <h3>Dashboard</h3>
    <button class="btn btn-secondary mt-2 mb-3" onclick="loadDashboard()">Refresh</button>

    <div class="row" id="dashboardBox"></div>
  </div>

  <!-- CREATE KEY -->
  <div class="panel-box">
    <h3>Create API Key</h3>

    <input id="createCredits" class="form-control mb-2" type="number" placeholder="Credits">
    <input id="createExpiry" class="form-control mb-2" type="datetime-local">
    <input id="createNotes" class="form-control mb-3" type="text" placeholder="Notes (optional)">

    <button class="btn btn-success" onclick="createKey()">Create Key</button>
    <div id="createResult" class="mt-2"></div>
  </div>

  <!-- MANAGE KEYS -->
  <div class="panel-box">
    <h3>Manage API Keys</h3>
    <button class="btn btn-secondary mb-3" onclick="loadKeys()">Reload</button>
    <a href="/admin/export" target="_blank" class="btn btn-info mb-3">Export CSV</a>

    <div id="keysTable"></div>
  </div>

  <!-- LOGS -->
  <div class="panel-box">
    <h3>Recent Usage Logs</h3>
    <button class="btn btn-secondary mb-3" onclick="loadLogs()">Reload</button>
    <div id="logsTable"></div>
  </div>

  <!-- CHANGE PASSWORD -->
  <div class="panel-box">
    <h3>Change Admin Password</h3>

    <input id="newAdminPass" class="form-control mb-2 w-50" type="password">
    <button class="btn btn-warning" onclick="changePassword()">Update</button>

    <div id="changePassResult" class="mt-2"></div>
  </div>

</div>

</body>
</html>
